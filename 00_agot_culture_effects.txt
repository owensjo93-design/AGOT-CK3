agot_innovations_setup_effect = {
	every_culture_global = {
		if = {
			limit = {
				agot_is_wildling_culture = yes
				has_dlc_feature = the_northern_lords
			}
			add_innovation = innovation_all_things
		}
		if = {
			limit = {
				agot_is_wildling_culture = no
			}
			add_innovation = innovation_battlements
		}
		if = {
			limit = {
				agot_is_wildling_culture = no
				NOR = {
					this = culture:andalosi
					this = culture:crannogman
					this = culture:skagosi
					this = culture:braavosi
					this = culture:norvoshi
					this = culture:pentoshi
					this = culture:hartalari
					this = culture:myrish
					this = culture:tyroshi
					this = culture:volantene
				}
				NAND = {
					this = culture:bearman
					game_start_date < 8000.1.1
				}
				NAND = {
					this = culture:krakenman
					game_start_date < 8000.1.1
				}
				NAND = {
					this = culture:wolfswood_clansman
					game_start_date < 8000.1.1
				}
				NAND = {
					this = culture:northern_clan
					game_start_date < 8100.1.1
				}
				NAND = {
					this = culture:sisterman
					game_start_date < 8175.1.1
				}
				NAND = {
					this = culture:valeman_finger
					game_start_date < 8150.1.1
				}
			}
			add_innovation = innovation_hoardings
		}
		if = {
			limit = {
				agot_is_wildling_culture = no
				NOR = {
					this = culture:andalosi
					this = culture:crannogman
					this = culture:skagosi
					this = culture:braavosi
					this = culture:norvoshi
					this = culture:pentoshi
					this = culture:hartalari
					this = culture:myrish
					this = culture:tyroshi
					this = culture:volantene

					this = culture:crownlander
					this = culture:valeman_finger
					this = culture:sisterman
					this = culture:clawman
					this = culture:barrowman
					this = culture:bearman
					this = culture:harborman
					this = culture:krakenman
					this = culture:northern_clan
					this = culture:northman
					this = culture:wolfswood_clansman
					this = culture:ironborn
				}
				NAND = {
					this = culture:stormlander_main
					game_start_date < 8260.1.1
				}
				NAND = {
					this = culture:marcher
					game_start_date < 8270.1.1
				}
				NAND = {
					this = culture:vineman
					game_start_date < 8270.1.1
				}
				NAND = {
					this = culture:honeywiner
					game_start_date < 8270.1.1
				}
				NAND = {
					this = culture:reachman
					game_start_date < 8270.1.1
				}
				NAND = {
					this = culture:shieldman
					game_start_date < 8270.1.1
				}
				NAND = {
					this = culture:riverman_main
					game_start_date < 8270.1.1
				}
				NAND = {
					this = culture:valeman_main
					game_start_date < 8270.1.1
				}
				NAND = {
					this = culture:valeman_upper
					game_start_date < 8270.1.1
				}
				NAND = {
					this = culture:high_valyrian
					game_start_date < 8270.1.1
				}
				NAND = {
					this = culture:stone_dornish
					game_start_date < 8280.1.1
				}
			}
			add_innovation = innovation_machicolations
		}
	}
	#AGOT AUH TODO Temp Fix
	if = {
		limit = { game_start_date >= 400.1.1 }
		culture:first_man = { add_innovation = innovation_agot_heraldry }
		culture:abular = { add_innovation = innovation_agot_heraldry }
	}
	if = {
		limit = { game_start_date >= 3300.1.1 }
		culture:andal = { add_innovation = innovation_development_03 }
		culture:axeman = { add_innovation = innovation_development_03 }
		culture:essosi_valyrian = { add_innovation = innovation_development_03 }
		culture:gogossite = { add_innovation = innovation_development_03 }
		culture:mantaryan = { add_innovation = innovation_development_03 }
		culture:tolosi = { add_innovation = innovation_development_03 }
		culture:elyrian = { add_innovation = innovation_development_03 }
		culture:painted_clansman = { add_innovation = innovation_development_03 }
		culture:essarian = { add_innovation = innovation_development_03 }
		culture:lorathi = { add_innovation = innovation_development_03 }
		culture:qohorik = { add_innovation = innovation_development_03 }
	}
	if = {
		limit = { game_start_date >= 7950.1.1 }
		culture:braavosi = { add_innovation = innovation_cranes }
		culture:volantene = { add_innovation = innovation_cranes }
	}
	if = {
		limit = { game_start_date >= 8096.1.1 }
		culture:hartalari = { add_innovation = innovation_rightful_ownership }
	}
	if = {
		limit = { game_start_date >= 8260.1.1 }
		culture:crownlander = { add_innovation = innovation_trebuchet }
		culture:honeywiner = { add_innovation = innovation_trebuchet }
		culture:marcher = { add_innovation = innovation_trebuchet }
		culture:reachman = { add_innovation = innovation_trebuchet }
		culture:salt_dornish = { add_innovation = innovation_trebuchet }
		culture:sand_dornish = { add_innovation = innovation_trebuchet }
		culture:stone_dornish = { add_innovation = innovation_trebuchet }
		culture:valeman_main = { add_innovation = innovation_trebuchet }
		culture:vineman = { add_innovation = innovation_trebuchet }
		culture:westerman_main = { add_innovation = innovation_trebuchet }
	}
	if = {
		limit = { game_start_date >= 8270.1.1 }
		culture:clawman = { add_innovation = innovation_trebuchet }
		culture:andal = { add_innovation = innovation_trebuchet }
		culture:axeman = { add_innovation = innovation_trebuchet }
		culture:essosi_valyrian = { add_innovation = innovation_trebuchet }
		culture:gogossite = { add_innovation = innovation_trebuchet }
		culture:mantaryan = { add_innovation = innovation_trebuchet }
		culture:tolosi = { add_innovation = innovation_trebuchet }
		culture:elyrian = { add_innovation = innovation_trebuchet }
		culture:painted_clansman = { add_innovation = innovation_trebuchet }
		culture:essarian = { add_innovation = innovation_trebuchet }
		culture:lorathi = { add_innovation = innovation_trebuchet }
		culture:qohorik = { add_innovation = innovation_trebuchet }
		culture:rhoynar_original = { add_innovation = innovation_cranes }
	}
	if = {
		limit = { game_start_date >= 8275.1.1 }
		culture:stormlander_main = { add_innovation = innovation_trebuchet }
	}
}

agot_culture_variable_setup_effect = {
	culture:high_valyrian = {
		if = {
			limit = { has_game_rule = agot_hv_conversion_offshoots }
			set_variable = {
				name = wv_culture
				value = culture:westerosi_valyrian
			}
			set_variable = {
				name = ev_culture
				value = culture:essosi_valyrian
			}
		}
	}
	culture:ironborn = {
		set_variable = {
			name = greenborn_culture
			value = culture:greenborn
		}
	}
	culture:greenborn = {
		set_variable = {
			name = ironborn_culture
			value = culture:ironborn
		}
	}
	culture:fangman = {
		set_variable = wildling_culture
	}
	culture:forestman = {
		set_variable = wildling_culture
	}
	culture:nightrunner = {
		set_variable = wildling_culture
	}
	culture:frozen_shoreman = {
		set_variable = wildling_culture
	}
	culture:hornfoot = {
		set_variable = wildling_culture
	}
	culture:lakefolk = {
		set_variable = wildling_culture
	}
	culture:ice_riverman = {
		set_variable = wildling_culture
	}
	culture:thenn = {
		set_variable = wildling_culture
	}
}

agot_automatic_culture_conversion = {
	agot_unknown_culture_conversion = yes
	agot_high_valyrian_conversion = yes
}

agot_unknown_culture_conversion = {
	if = {
		limit = {
			culture = culture:unknown_culture
			NOT = { agot_is_dummy_character = yes }
		}
		if = {
			limit = {
				exists = capital_county
				NOT = { capital_county.culture = culture:unknown_culture }
			}
			set_culture = capital_county.culture
		}
		else_if = {
			limit = {
				exists = liege_or_court_owner
				NOT = { liege_or_court_owner.culture = culture:unknown_culture }
			}
			set_culture = liege_or_court_owner.culture
		}
		else = {
			random_ruler = {
				limit = {
					NOT = { agot_is_dummy_character = yes }
				}
				prev = { set_culture = prev.culture }
			}
		}
		add_character_flag = {
			flag = converted_unknown_culture
			days = 1
		}
	}
}

agot_high_valyrian_conversion = {
	if = {
		limit = {
			has_culture = culture:high_valyrian
			OR = {
				is_lowborn = yes
				agot_has_fake_dynasty = yes
			}
			#stop bastards from getting converted before they are assigned a house
			trigger_if = {
				limit = {
					exists = mother
					exists = mother.dynasty
				}
				NOT = { mother.culture = culture:high_valyrian }
			}
		}
		if = {
			limit = {
				OR = {
					employer ?= {
						capital_province ?= {
							NOT = { geographical_region = world_westeros }
						}
					}
					scope:new_employer ?= {
						capital_province ?= {
							NOT = { geographical_region = world_westeros }
						}
					}
					scope:host ?= {
						capital_province ?= {
							NOT = { geographical_region = world_westeros }
						}
					}
					location ?= {
						county ?= {
							title_province ?= {
								NOT = { geographical_region = world_westeros }
							}
						}
					}
				}
			}
			set_culture = culture:essosi_valyrian
		}
		else = {
			set_culture = culture:westerosi_valyrian
		}
	}
}

agot_set_culture_descriptions_effect = {
	culture:high_valyrian = {
		add_to_list = culture_desc_builder
	}
	culture:axeman = {
		add_to_list = culture_desc_builder
	}
	culture:essarian = {
		add_to_list = culture_desc_builder
	}
	culture:lorathi = {
		add_to_list = culture_desc_builder
	}
	culture:norvoshi = {
		add_to_list = culture_desc_builder
	}
	culture:qohorik = {
		add_to_list = culture_desc_builder
	}
	culture:volantene = {
		add_to_list = culture_desc_builder
	}
	culture:dothraki = {
		add_to_list = culture_desc_builder
	}
	culture:lhazareen = {
		add_to_list = culture_desc_builder
	}
	culture:omberi = {
		add_to_list = culture_desc_builder
	}
	culture:chroyanar = {
		add_to_list = culture_desc_builder
	}
	culture:mellar = {
		add_to_list = culture_desc_builder
	}
	culture:noynar = {
		add_to_list = culture_desc_builder
	}
	culture:qhoynar = {
		add_to_list = culture_desc_builder
	}
	culture:rhoynar_original = {
		add_to_list = culture_desc_builder
	}
	culture:sarhar = {
		add_to_list = culture_desc_builder
	}
	culture:sarar = {
		add_to_list = culture_desc_builder
	}
	culture:trimbaez_fen = {
		add_to_list = culture_desc_builder
	}
	culture:cymmeri = {
		add_to_list = culture_desc_builder
	}
	culture:gipps = {
		add_to_list = culture_desc_builder
	}
	culture:zoqora = {
		add_to_list = culture_desc_builder
	}
	culture:goraez_fen = {
		add_to_list = culture_desc_builder
	}
	culture:zanhar_fen = {
		add_to_list = culture_desc_builder
	}
	culture:madekh_fen = {
		add_to_list = culture_desc_builder
	}
	culture:tagaez_fen = {
		add_to_list = culture_desc_builder
	}
	culture:gilal_fen = {
		add_to_list = culture_desc_builder
	}
	culture:cenaakh_fen = {
		add_to_list = culture_desc_builder
	}
	culture:giren_fen = {
		add_to_list = culture_desc_builder
	}
	culture:zivylar_fen = {
		add_to_list = culture_desc_builder
	}
	culture:cewi_fen = {
		add_to_list = culture_desc_builder
	}
	culture:dawiz_fen = {
		add_to_list = culture_desc_builder
	}
	culture:essosi_valyrian = {
		add_to_list = culture_desc_builder
	}
	culture:valyrian_original = {
		add_to_list = culture_desc_builder
	}
	# Rest of the World
	culture:children_culture = {
		add_to_list = culture_desc_builder
	}
	culture:dragon_culture = {
		add_to_list = culture_desc_builder
	}
	culture:giant_culture = {
		add_to_list = culture_desc_builder
	}
	culture:ifequevron = {
		add_to_list = culture_desc_builder
	}
	culture:jhogwin = {
		add_to_list = culture_desc_builder
	}
	culture:fisher_queen_race = {
		add_to_list = culture_desc_builder
	}
	culture:others_culture = {
		add_to_list = culture_desc_builder
	}
	culture:mazemaker = {
		add_to_list = culture_desc_builder
	}
	culture:andal = {
		add_to_list = culture_desc_builder
	}
	culture:andalosi = {
		add_to_list = culture_desc_builder
	}
	culture:axeman = {
		add_to_list = culture_desc_builder
	}
	culture:crownlander = {
		add_to_list = culture_desc_builder
	}
	# culture:sandman = {
	# 	add_to_list = culture_desc_builder
	# }
	culture:vineman = {
		add_to_list = culture_desc_builder
	}
	# culture:groveman = {
	# 	add_to_list = culture_desc_builder
	# }
	culture:honeywiner = {
		add_to_list = culture_desc_builder
	}
	culture:reachman = {
		add_to_list = culture_desc_builder
	}
	culture:shieldman = {
		add_to_list = culture_desc_builder
	}
	culture:riverman_main = {
		add_to_list = culture_desc_builder
	}
	# culture:bay_riverman = {
	# 	add_to_list = culture_desc_builder
	# }
	# culture:cape_riverman = {
	# 	add_to_list = culture_desc_builder
	# }
	# culture:green_riverman = {
	# 	add_to_list = culture_desc_builder
	# }
	# culture:highland_riverman = {
	# 	add_to_list = culture_desc_builder
	# }
	# culture:lake_riverman = {
	# 	add_to_list = culture_desc_builder
	# }
	# culture:rush_riverman = {
	# 	add_to_list = culture_desc_builder
	# }
	# culture:cape_stormlander = {
	# 	add_to_list = culture_desc_builder
	# }
	# culture:hook_stormlander = {
	# 	add_to_list = culture_desc_builder
	# }
	culture:stormlander_main = {
		add_to_list = culture_desc_builder
	}
	# culture:tarthman = {
	# 	add_to_list = culture_desc_builder
	# }
	culture:marcher = {
		add_to_list = culture_desc_builder
	}
	# culture:bite_valeman = {
	# 	add_to_list = culture_desc_builder
	# }
	culture:valeman_finger = {
		add_to_list = culture_desc_builder
	}
	culture:valeman_main = {
		add_to_list = culture_desc_builder
	}
	culture:sisterman = {
		add_to_list = culture_desc_builder
	}
	culture:valeman_upper = {
		add_to_list = culture_desc_builder
	}
	# culture:green_westerman = {
	# 	add_to_list = culture_desc_builder
	# }
	# culture:hill_westerman = {
	# 	add_to_list = culture_desc_builder
	# }
	culture:westerman_main = {
		add_to_list = culture_desc_builder
	}
	# culture:shore_westerman = {
	# 	add_to_list = culture_desc_builder
	# }
	culture:clawman = {
		add_to_list = culture_desc_builder
	}
	culture:first_man = {
		add_to_list = culture_desc_builder
	}
	culture:barrowman = {
		add_to_list = culture_desc_builder
	}
	culture:bearman = {
		add_to_list = culture_desc_builder
	}
	culture:crannogman = {
		add_to_list = culture_desc_builder
	}
	culture:harborman = {
		add_to_list = culture_desc_builder
	}
	culture:krakenman = {
		add_to_list = culture_desc_builder
	}
	culture:northern_clan = {
		add_to_list = culture_desc_builder
	}
	culture:northman = {
		add_to_list = culture_desc_builder
	}
	culture:skagosi = {
		add_to_list = culture_desc_builder
	}
	culture:wolfswood_clansman = {
		add_to_list = culture_desc_builder
	}
	culture:braavosi = {
		add_to_list = culture_desc_builder
	}
	# culture:essari = {
	# 	add_to_list = culture_desc_builder
	# }
	culture:lorathi = {
		add_to_list = culture_desc_builder
	}
	culture:norvoshi = {
		add_to_list = culture_desc_builder
	}
	culture:pentoshi = {
		add_to_list = culture_desc_builder
	}
	culture:nonteloshi = {
		add_to_list = culture_desc_builder
	}
	culture:qohorik = {
		add_to_list = culture_desc_builder
	}
	culture:hartalari = {
		add_to_list = culture_desc_builder
	}
	culture:lyseni = {
		add_to_list = culture_desc_builder
	}
	culture:myrish = {
		add_to_list = culture_desc_builder
	}
	culture:tyroshi = {
		add_to_list = culture_desc_builder
	}
	culture:volantene = {
		add_to_list = culture_desc_builder
	}
	culture:ghaeni = {
		add_to_list = culture_desc_builder
	}
	culture:ghardaqi = {
		add_to_list = culture_desc_builder
	}
	culture:ghiscari_original = {
		add_to_list = culture_desc_builder
	}
	culture:shuzduni = {
		add_to_list = culture_desc_builder
	}
	culture:hazdahni = {
		add_to_list = culture_desc_builder
	}
	culture:astapori = {
		add_to_list = culture_desc_builder
	}
	culture:meereenese = {
		add_to_list = culture_desc_builder
	}
	culture:yunkaii = {
		add_to_list = culture_desc_builder
	}
	culture:gorgari = {
		add_to_list = culture_desc_builder
	}
	culture:goroshari = {
		add_to_list = culture_desc_builder
	}
	culture:zamettari = {
		add_to_list = culture_desc_builder
	}
	culture:dothraki = {
		add_to_list = culture_desc_builder
	}
	culture:lhazareen = {
		add_to_list = culture_desc_builder
	}
	culture:omberi = {
		add_to_list = culture_desc_builder
	}
	# culture:hairy_forest = {
	# 	add_to_list = culture_desc_builder
	# }
	# culture:hairy_isle = {
	# 	add_to_list = culture_desc_builder
	# }
	# culture:hairy_rivers = {
	# 	add_to_list = culture_desc_builder
	# }
	culture:bayasabhadan = {
		add_to_list = culture_desc_builder
	}
	culture:hyrkoonan_original = {
		add_to_list = culture_desc_builder
	}
	culture:kayakayanayan = {
		add_to_list = culture_desc_builder
	}
	culture:shamyrianan = {
		add_to_list = culture_desc_builder
	}
	culture:shan_ren = {
		add_to_list = culture_desc_builder
	}
	culture:ibbatese = {
		add_to_list = culture_desc_builder
	}
	culture:ibbenese = {
		add_to_list = culture_desc_builder
	}
	culture:ib_sarese = {
		add_to_list = culture_desc_builder
	}
	culture:greenborn = {
		add_to_list = culture_desc_builder
	}
	culture:ironborn = {
		add_to_list = culture_desc_builder
	}
	culture:jade_islander = {
		add_to_list = culture_desc_builder
	}
	culture:lengii = {
		add_to_list = culture_desc_builder
	}
	culture:manticorian = {
		add_to_list = culture_desc_builder
	}
	culture:marahaiian = {
		add_to_list = culture_desc_builder
	}
	culture:bloodless_man = {
		add_to_list = culture_desc_builder
	}
	culture:carcosan = {
		add_to_list = culture_desc_builder
	}
	culture:dathian = {
		add_to_list = culture_desc_builder
	}
	culture:grey_man = {
		add_to_list = culture_desc_builder
	}
	culture:fish_man = {
		add_to_list = culture_desc_builder
	}
	culture:lion_man = {
		add_to_list = culture_desc_builder
	}
	culture:mossovite = {
		add_to_list = culture_desc_builder
	}
	culture:shryke = {
		add_to_list = culture_desc_builder
	}
	culture:winged_man = {
		add_to_list = culture_desc_builder
	}
	culture:farosi = {
		add_to_list = culture_desc_builder
	}
	culture:moraqi = {
		add_to_list = culture_desc_builder
	}
	culture:vahari = {
		add_to_list = culture_desc_builder
	}
	culture:zabhadi = {
		add_to_list = culture_desc_builder
	}
	culture:jogos_nhai = {
		add_to_list = culture_desc_builder
	}
	culture:nefer = {
		add_to_list = culture_desc_builder
	}
	culture:qaathi = {
		add_to_list = culture_desc_builder
	}
	culture:qaleen = {
		add_to_list = culture_desc_builder
	}
	culture:qartheen = {
		add_to_list = culture_desc_builder
	}
	culture:greenblood = {
		add_to_list = culture_desc_builder
	}
	culture:salt_dornish = {
		add_to_list = culture_desc_builder
	}
	culture:sand_dornish = {
		add_to_list = culture_desc_builder
	}
	culture:stone_dornish = {
		add_to_list = culture_desc_builder
	}
	culture:abular = {
		add_to_list = culture_desc_builder
	}
	culture:asshaii = {
		add_to_list = culture_desc_builder
	}
	culture:shadowman = {
		add_to_list = culture_desc_builder
	}
	culture:basiliskite = {
		add_to_list = culture_desc_builder
	}
	culture:brindled_man = {
		add_to_list = culture_desc_builder
	}
	culture:gogossite = {
		add_to_list = culture_desc_builder
	}
	culture:yeenite = {
		add_to_list = culture_desc_builder
	}
	culture:naathi = {
		add_to_list = culture_desc_builder
	}
	culture:jhalai = {
		add_to_list = culture_desc_builder
	}
	culture:moluuni = {
		add_to_list = culture_desc_builder
	}
	culture:omborui = {
		add_to_list = culture_desc_builder
	}
	culture:walanoi = {
		add_to_list = culture_desc_builder
	}
	culture:essosi_valyrian = {
		add_to_list = culture_desc_builder
	}
	culture:painted_clansman = {
		add_to_list = culture_desc_builder
	}
	culture:elyrian = {
		add_to_list = culture_desc_builder
	}
	# culture:bhorashi = {
	# 	add_to_list = culture_desc_builder
	# }
	culture:mantaryan = {
		add_to_list = culture_desc_builder
	}
	culture:tolosi = {
		add_to_list = culture_desc_builder
	}
	culture:high_valyrian = {
		add_to_list = culture_desc_builder
	}
	culture:westerosi_valyrian = {
		add_to_list = culture_desc_builder
	}
	culture:cave_dweller = {
		add_to_list = culture_desc_builder
	}
	culture:fangman = {
		add_to_list = culture_desc_builder
	}
	culture:first_clan = {
		add_to_list = culture_desc_builder
	}
	culture:forestman = {
		add_to_list = culture_desc_builder
	}
	culture:frozen_shoreman = {
		add_to_list = culture_desc_builder
	}
	culture:hornfoot = {
		add_to_list = culture_desc_builder
	}
	culture:ice_riverman = {
		add_to_list = culture_desc_builder
	}
	culture:lakefolk = {
		add_to_list = culture_desc_builder
	}
	culture:milkwaterman = {
		add_to_list = culture_desc_builder
	}
	culture:nightrunner = {
		add_to_list = culture_desc_builder
	}
	culture:thenn = {
		add_to_list = culture_desc_builder
	}
	culture:moon_clan = {
		add_to_list = culture_desc_builder
	}
	culture:aobao_ren = {
		add_to_list = culture_desc_builder
	}
	culture:bixi_ren = {
		add_to_list = culture_desc_builder
	}
	culture:haungyu_ren = {
		add_to_list = culture_desc_builder
	}
	culture:heinao_ren = {
		add_to_list = culture_desc_builder
	}
	culture:feicui_ren = {
		add_to_list = culture_desc_builder
	}
	culture:zhenzhu_ren = {
		add_to_list = culture_desc_builder
	}
	every_in_list = {
		list = culture_desc_builder
		create_character = {
			location = title:b_ruins.title_province
			gender = male
			dynasty = none
			faith = title:b_ruins.holder.faith
			culture = this
			save_scope_as = culture_dummy
			after_creation = {
				prev = {
					set_variable = {
						name = agot_culture_tt_desc
						value = scope:culture_dummy
					}
				}
				death = {
					death_reason = death_vanished
				}
				agot_make_unpruneable = yes
			}
		}
	}
}