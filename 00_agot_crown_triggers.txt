agot_can_wear_crown_trigger = {
	custom_tooltip = {
		text = agot_is_independent_crown_tooltip_desc
		OR = {
			agot_is_independent_ruler = yes
			primary_spouse ?= {
				agot_is_independent_ruler = yes
			}
			father ?= {
				agot_is_independent_ruler = yes
			}
			mother ?= {
				agot_is_independent_ruler = yes
			}
			any_heir_title = {
				holder ?= { agot_is_independent_ruler = yes }
			}
			AND = {
				highest_held_title_tier = tier_kingdom
				vassal_contract_has_flag = has_palatinate_contract
			}
			AND = {
				primary_title ?= { tier >= tier_kingdom }
				any_character_war = {
					using_cb = agot_independence_war
					is_war_leader = root
					is_attacker = root
				}
			}
			has_character_flag = agot_claimant_king
		}
		OR = {
			is_ai = no
			AND = {
				NOT = { government_has_flag = government_is_free_city }
				NOT = { has_government = republic_government }
			}
		}
	}
	#Coronation Logic
	trigger_if = {
		limit = {
			NOR = {
				government_has_flag = government_is_free_city
				has_government = republic_government
			}
			agot_is_independent_ruler = yes
		}
		custom_tooltip = {
			text = must_be_crowned_tooltip_desc
			agot_is_coronated_trigger = yes
		}
	}
	trigger_else_if = {
		limit = {
			NOR = {
				government_has_flag = government_is_free_city
				has_government = republic_government
			}
			OR = {
				primary_spouse ?= {
					agot_is_independent_ruler = yes
				}
				father ?= {
					agot_is_independent_ruler = yes
				}
				mother ?= {
					agot_is_independent_ruler = yes
				}
				any_heir_title = {
					holder ?= { agot_is_independent_ruler = yes }
				}
			}
		}
		custom_tooltip = {
			text = must_be_crowned_tooltip_desc
			OR = {
				primary_spouse ?= {
					agot_is_coronated_trigger = yes
				}
				father ?= {
					agot_is_coronated_trigger = yes
				}
				mother ?= {
					agot_is_coronated_trigger = yes
				}
				any_heir_title = {
					holder ?= { agot_is_coronated_trigger = yes }
				}
			}
		}
	}
	trigger_else = {
		always = yes
	}
	NOT = { has_trait = nightswatch }
}

agot_default_wear_crown_trigger = {
	trigger_if = { #To ensure if crown is stolen, ruler will not wear crown unless manually equipped.
		limit = {
			involved_activity ?= {
				has_activity_type = activity_agot_coronation
				has_variable = misplaced_crown #Make sure the crown is stolen and not returned
			}
			has_character_flag = coronation_host #Make sure this is the host
			is_alive = yes
		}
		any_character_artifact = {
			artifact_slot_type = helmet
			is_equipped = yes
		}
	}
	trigger_else_if = {
		limit = { is_alive = yes }
		OR = {
			AND = {
				primary_title ?= { tier >= tier_kingdom }
				any_character_war = {
					using_cb = agot_independence_war
					is_war_leader = root
					is_attacker = root
				}
			}
			has_character_flag = agot_claimant_king
			AND = {
				OR = {
					primary_title ?= { tier >= tier_kingdom }
					primary_spouse ?= {
						primary_title ?= { tier >= tier_kingdom }
					}
				}
				OR = {
					AND = {
						agot_is_independent_ruler = yes
						agot_is_coronated_trigger = yes
					}
					primary_spouse ?= {
						agot_is_independent_ruler = yes
						agot_is_coronated_trigger = yes
					}
					AND = {
						highest_held_title_tier = tier_kingdom
						vassal_contract_has_flag = has_palatinate_contract
						NOT = { primary_title ?= title:k_dragonstone }
					}
				}
			}
		}
	}
	trigger_else = {
		OR = {
			AND = {
				primary_title.tier = tier_empire
				agot_is_coronated_trigger = yes
			}
			has_primary_title = title:k_dorne
			any_spouse = {
				even_if_dead = yes
				primary_title.tier = tier_empire
				agot_is_coronated_trigger = yes
			}
		}
	}
	NOT = { government_has_flag = government_is_free_city }
	NOT = { has_government = republic_government }
}