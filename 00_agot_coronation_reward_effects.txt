disburse_agot_coronation_activity_rewards = {
	# for the loc
	save_scope_as = root_scope

	scope:activity = {
		### Rewards based on Options
		# Pomp
		if = {
			limit = {
				has_activity_option = {
					category = coronation_option_pomp
					option = coronation_pomp_grandiose
				}
			}
			add_activity_log_entry = {
				key = host_coronation_pomp_grandiose
				tags = { completed }
				score = 100
				# this line below adds the entry to the Effects section of the conclusion UI
				show_in_conclusion = yes
				character = scope:root_scope

				scope:host = {
					add_piety = miniscule_piety_gain
					add_legitimacy = major_legitimacy_gain
					add_character_modifier = {
						modifier = coronation_grandiose_modifier
						years = 20
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = courtly
								is_participant_in_activity = scope:activity
							}
						}
						custom = every_courtly_vassal_coronation
						add_opinion = {
							modifier = hosted_grandiose_coronation_opinion
							target = scope:host
							opinion = 30
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = glory_hound
								is_participant_in_activity = scope:activity
							}
						}
						custom = every_glory_hound_vassal_coronation
						add_opinion = {
							modifier = hosted_grandiose_coronation_opinion
							target = scope:host
							opinion = 30
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = parochial
								is_participant_in_activity = scope:activity
							}
						}
						custom = every_parochial_vassal_coronation
						add_opinion = {
							modifier = hosted_grandiose_coronation_opinion
							target = scope:host
							opinion = -30
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = zealot
								is_participant_in_activity = scope:activity
								faith.religious_head = scope:host.faith.religious_head
								NOT = {
									scope:activity.special_guest:coronation_officiant ?= faith.religious_head
								}
							}
						}
						custom = every_zealot_vassal_coronation
						add_opinion = {
							modifier = hosted_grandiose_coronation_opinion
							target = scope:host
							opinion = -30
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = zealot
								is_participant_in_activity = scope:activity
								scope:activity.special_guest:coronation_officiant ?= faith.religious_head
								faith.religious_head = scope:host.faith.religious_head
							}
						}
						custom = every_zealot_vassal_coronation
						add_opinion = {
							modifier = hof_officiated_coronation_opinion
							target = scope:host
							opinion = 30
						}
					}
				}
				every_attending_character = {
					limit = {
						NOT = {
							this = scope:host
						}
					}
					custom = custom.every_activity_guest
					add_piety = miniscule_piety_gain
				}
			}
		}
		else_if = {
			limit = {
				has_activity_option = {
					category = coronation_option_pomp
					option = coronation_pomp_impressive
				}
			}
			add_activity_log_entry = {
				key = host_coronation_pomp_impressive
				tags = { completed }
				score = 100
				# this line below adds the entry to the Effects section of the conclusion UI
				show_in_conclusion = yes
				character = scope:root_scope

				scope:host = {
					add_piety = minor_piety_gain
					add_legitimacy = medium_legitimacy_gain
					add_character_modifier = {
						modifier = coronation_impressive_modifier
						years = 20
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = courtly
								is_participant_in_activity = scope:activity
							}
						}
						custom = every_courtly_vassal_coronation
						add_opinion = {
							modifier = hosted_impressive_coronation_opinion
							target = scope:host
							opinion = 30
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = glory_hound
								is_participant_in_activity = scope:activity
							}
						}
						custom = every_glory_hound_vassal_coronation
						add_opinion = {
							modifier = hosted_impressive_coronation_opinion
							target = scope:host
							opinion = 15
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = parochial
								is_participant_in_activity = scope:activity
							}
						}
						custom = every_parochial_vassal_coronation
						add_opinion = {
							modifier = hosted_impressive_coronation_opinion
							target = scope:host
							opinion = -15
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = zealot
								is_participant_in_activity = scope:activity
								NOT = {
									scope:activity.special_guest:coronation_officiant ?= faith.religious_head
								}
								faith.religious_head = scope:host.faith.religious_head
							}
						}
						custom = every_zealot_vassal_coronation
						add_opinion = {
							modifier = hosted_impressive_coronation_opinion
							target = scope:host
							opinion = -15
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = zealot
								is_participant_in_activity = scope:activity
								scope:activity.special_guest:coronation_officiant ?= faith.religious_head
								faith.religious_head = scope:host.faith.religious_head
							}
						}
						custom = every_zealot_vassal_coronation
						add_opinion = {
							modifier = hof_officiated_coronation_opinion
							target = scope:host
							opinion = 30
						}
					}
				}
				every_attending_character = {
					limit = {
						NOT = {
							this = scope:host
						}
					}
					custom = custom.every_activity_guest
					add_piety = minor_piety_gain
				}
			}
		}
		else_if = {
			limit = {
				has_activity_option = {
					category = coronation_option_pomp
					option = coronation_pomp_appropriate
				}
			}
			add_activity_log_entry = {
				key = host_coronation_pomp_appropriate
				tags = { completed }
				score = 100
				# this line below adds the entry to the Effects section of the conclusion UI
				show_in_conclusion = yes
				character = scope:root_scope

				scope:host = {
					add_piety = major_piety_gain
					add_legitimacy = minor_legitimacy_gain
					add_character_modifier = {
						modifier = coronation_appropriate_modifier
						years = 20
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = courtly
								is_participant_in_activity = scope:activity
							}
						}
						custom = every_courtly_vassal_coronation
						add_opinion = {
							modifier = hosted_appropriate_coronation_opinion
							target = scope:host
							opinion = -15
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = glory_hound
								is_participant_in_activity = scope:activity
							}
						}
						custom = every_glory_hound_vassal_coronation
						add_opinion = {
							modifier = hosted_appropriate_coronation_opinion
							target = scope:root_scope
							opinion = -15
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = parochial
								is_participant_in_activity = scope:activity
							}
						}
						custom = every_parochial_vassal_coronation
						add_opinion = {
							modifier = hosted_appropriate_coronation_opinion
							target = scope:root_scope
							opinion = 30
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = zealot
								is_participant_in_activity = scope:activity
								NOT = {
									scope:activity.special_guest:coronation_officiant ?= faith.religious_head
								}
								faith.religious_head = scope:host.faith.religious_head
							}
						}
						custom = every_zealot_vassal_coronation
						add_opinion = {
							modifier = hosted_appropriate_coronation_opinion
							target = scope:host
							opinion = 15
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = zealot
								is_participant_in_activity = scope:activity
								scope:activity.special_guest:coronation_officiant ?= faith.religious_head
								faith.religious_head = scope:host.faith.religious_head
							}
						}
						custom = every_zealot_vassal_coronation
						add_opinion = {
							modifier = hof_officiated_coronation_opinion
							target = scope:host
							opinion = 30
						}
					}
				}
				every_attending_character = {
					limit = {
						NOT = {
							this = scope:host
						}
					}
					custom = custom.every_activity_guest
					add_piety = major_piety_gain
				}
			}
		}
		else_if = {
			limit = {
				has_activity_option = {
					category = coronation_option_pomp
					option = coronation_pomp_humble
				}
			}
			add_activity_log_entry = {
				key = host_coronation_pomp_humble
				tags = { completed }
				score = 100
				# this line below adds the entry to the Effects section of the conclusion UI
				show_in_conclusion = yes
				character = scope:root_scope

				scope:host = {
					add_piety = massive_piety_gain
					add_legitimacy = miniscule_legitimacy_gain
					add_character_modifier = {
						modifier = coronation_humble_modifier
						years = 20
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = courtly
								is_participant_in_activity = scope:activity
							}
						}
						custom = every_courtly_vassal_coronation
						add_opinion = {
							modifier = hosted_humble_coronation_opinion
							target = scope:host
							opinion = -30
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = glory_hound
								is_participant_in_activity = scope:activity
							}
						}
						custom = every_glory_hound_vassal_coronation
						add_opinion = {
							modifier = hosted_humble_coronation_opinion
							target = scope:host
							opinion = -30
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = parochial
								is_participant_in_activity = scope:activity
							}
						}
						custom = every_parochial_vassal_coronation
						add_opinion = {
							modifier = hosted_humble_coronation_opinion
							target = scope:host
							opinion = 15
						}
					}
					every_vassal_or_below = {
						limit = {
							AND = {
								has_vassal_stance = zealot
								is_participant_in_activity = scope:activity
								faith = scope:host.faith
							}
						}
						custom = every_zealot_vassal_coronation
						add_opinion = {
							modifier = hosted_humble_coronation_opinion
							target = scope:host
							opinion = 30
						}
					}
				}
				every_attending_character = {
					limit = {
						NOT = {
							this = scope:host
						}
					}
					custom = custom.every_activity_guest
					add_piety = massive_piety_gain
				}
			}
		}
		# Entertainment
		if = {
			limit = {
				has_activity_option = {
					category = wedding_option_entertainment
					option = wedding_entertainment_good
				}
			}
			add_activity_log_entry = {
				key = host_coronation_entertainment_good
				tags = { completed }
				score = 100
				# this line below adds the entry to the Effects section of the conclusion UI
				show_in_conclusion = yes
				character = scope:root_scope

				scope:host = { add_prestige = 900 }
				every_attending_character = {
					limit = {
						NOT = {
							this = scope:host
						}
					}
					custom = custom.every_activity_guest
					add_prestige = major_prestige_gain
				}
			}
		}
		else_if = {
			limit = {
				has_activity_option = {
					category = wedding_option_entertainment
					option = wedding_entertainment_normal
				}
			}
			add_activity_log_entry = {
				key = host_coronation_entertainment_normal
				tags = { completed }
				score = 100
				# this line below adds the entry to the Effects section of the conclusion UI
				show_in_conclusion = yes
				character = scope:root_scope

				scope:host = { add_prestige = 600 }
				every_attending_character = {
					limit = {
						NOT = {
							this = scope:host
						}
					}
					custom = custom.every_activity_guest
					add_prestige = medium_prestige_gain
				}
			}
		}
		else_if = {
			limit = {
				has_activity_option = {
					category = wedding_option_entertainment
					option = wedding_entertainment_bad
				}
			}
			add_activity_log_entry = {
				key = host_coronation_entertainment_bad
				tags = { completed }
				score = 100
				# this line below adds the entry to the Effects section of the conclusion UI
				show_in_conclusion = yes
				character = scope:root_scope

				scope:host = { add_prestige = 300 }
				every_attending_character = {
					limit = {
						NOT = {
							this = scope:host
						}
					}
					custom = custom.every_activity_guest
					add_prestige = minor_prestige_gain
				}
			}
		}

		# Food
		if = {
			limit = {
				has_activity_option = {
					category = wedding_option_food
					option = wedding_food_good
				}
			}
			add_activity_log_entry = {
				key = host_coronation_food_good
				tags = { completed }
				score = 100
				# this line below adds the entry to the Effects section of the conclusion UI
				show_in_conclusion = yes
				character = scope:root_scope

				scope:host = {
					if = {
						limit = {
							has_trait = lifestyle_reveler
						}
						add_trait_xp = {
							trait = lifestyle_reveler
							value = 10
						}
					}
					else = {
						add_trait = lifestyle_reveler
					}
				}

				every_attending_character = {
					limit = { NOT = { this = scope:host } }
					custom = custom.every_activity_guest
					add_opinion = {
						target = scope:host
						modifier = impressed_opinion
						opinion = 30
					}
					if = {
						limit = {
							has_trait = lifestyle_reveler
						}
						add_trait_xp = {
							trait = lifestyle_reveler
							value = 10
						}
					}
					# Guest opinion from host and spouses
					if = {
						limit = {
							exists = scope:host
						}
						hidden_effect = {
							reverse_add_opinion = {
								target = scope:host
								modifier = came_to_my_coronation_opinion
								opinion = 15
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				has_activity_option = {
					category = wedding_option_food
					option = wedding_food_normal
				}
			}
			add_activity_log_entry = {
				key = host_coronation_food_normal
				tags = { completed }
				score = 100
				# this line below adds the entry to the Effects section of the conclusion UI
				show_in_conclusion = yes
				character = scope:root_scope

				every_attending_character = {
					limit = { NOT = { this = scope:host } }
					custom = custom.every_activity_guest
					add_opinion = {
						target = scope:host
						modifier = impressed_opinion
						opinion = 20
					}
					if = {
						limit = {
							has_trait = lifestyle_reveler
						}
						add_trait_xp = {
							trait = lifestyle_reveler
							value = 5
						}
					}
					# Opinion from host and spouses
					if = {
						limit = {
							exists = scope:host
						}
						hidden_effect = {
							reverse_add_opinion = {
								target = scope:host
								modifier = came_to_my_coronation_opinion
								opinion = 10
							}
						}
					}
				}
			}
		}
		else_if = {
			limit = {
				has_activity_option = {
					category = wedding_option_food
					option = wedding_food_bad
				}
			}
			add_activity_log_entry = {
				key = host_coronation_food_bad
				tags = { completed }
				score = 100
				# this line below adds the entry to the Effects section of the conclusion UI
				show_in_conclusion = yes
				character = scope:root_scope

				every_attending_character = {
					limit = { NOT = { this = scope:host } }
					custom = custom.every_activity_guest
					add_opinion = {
						target = scope:host
						modifier = impressed_opinion
						opinion = 5
					}
					if = {
						limit = {
							has_trait = lifestyle_reveler
						}
						add_trait_xp = {
							trait = lifestyle_reveler
							value = 3
						}
					}
					# Opinion from host and spouses
					if = {
						limit = {
							exists = scope:host
						}
						hidden_effect = {
							reverse_add_opinion = {
								target = scope:host
								modifier = came_to_my_coronation_opinion
								opinion = 5
							}
						}
					}
				}
			}
		}
	}

	# Bonuses for location
	if = {
		limit = {
			scope:coronation_venue = {
				OR = {
					has_building_or_higher = royal_garden_01
					has_building_or_higher = leisure_palace_01
					has_building = the_red_keep_01
					has_building = the_red_keep_02
					has_building = the_red_keep_03
					has_building = agot_summerhall_01
					has_building = agot_summerhall_ruins_02
					has_building_or_higher = holy_site_great_sept_01
					has_building_or_higher = holy_site_starry_sept_01
					barony = { is_holy_site_of = scope:host.faith }
					barony = { is_holy_site_of = scope:spouse_1.faith }
					barony = { is_holy_site_of = scope:spouse_2.faith }
					this = scope:host.capital_province
				}
			}
		}
		scope:activity = {
			add_activity_log_entry = {
				key = host_coronation_venue
				tags = { completed }
				score = 100
				# this line below adds the entry to the Effects section of the conclusion UI
				show_in_conclusion = yes
				character = scope:root_scope

				if = {
					limit = {
						OR = {
							scope:coronation_venue = { has_building_or_higher = royal_garden_03 }
							scope:coronation_venue = { has_building_or_higher = leisure_palace_03 }
							scope:coronation_venue = { has_building_or_higher = the_red_keep_03 }
							scope:coronation_venue = { has_building_or_higher = holy_site_great_sept_01 }
							scope:coronation_venue = { has_building_or_higher = holy_site_starry_sept_01 }
						}
					}
					root = {
						stress_impact = {
							base = massive_stress_impact_loss
						}
					}
					scope:host = {
						dynasty ?= { add_dynasty_prestige = major_dynasty_prestige_gain }
					}
				}
				else_if = {
					limit = {
						OR = {
							scope:coronation_venue = { has_building_or_higher = royal_garden_02 }
							scope:coronation_venue = { has_building_or_higher = leisure_palace_02 }
							scope:coronation_venue = { has_building_or_higher = the_red_keep_02 }
						}
					}
					root = {
						stress_impact = {
							base = major_stress_impact_loss
						}
					}
					scope:host = {
						dynasty ?= { add_dynasty_prestige = minor_dynasty_prestige_gain }
					}
				}
				else_if = {
					limit = {
						OR = {
							scope:coronation_venue = { has_building_or_higher = royal_garden_01 }
							scope:coronation_venue = { has_building_or_higher = leisure_palace_01 }
							scope:coronation_venue = { has_building_or_higher = the_red_keep_01 }
						}
					}
					root = {
						stress_impact = {
							base = medium_stress_impact_loss
						}
					}
					scope:host = {
						dynasty ?= { add_dynasty_prestige = 10 }
					}
					if = {
						limit = {
							NOT = {
								this = scope:host
							}
						}
						stress_impact = {
							base = medium_stress_impact_loss
						}
					}
				}
				if = {
					limit = {
						scope:coronation_venue = {
							barony = { is_holy_site_of = scope:host.faith }
						}
					}
					scope:host = {
						add_piety = major_piety_gain
					}
				}
				if = {
					limit = {
						scope:coronation_venue = {
							this = root.capital_province
						}
					}
					# Replace marriage_effect.2001
					scope:host = {
						add_gold = minor_gold_value
					}
				}
			}
		}
	}

	# If character had the reduce stress intent, give them stress loss
	root = { disburse_activity_stress_loss = yes }

	# If character had the promote rule intent, give them legitimacy
	root = {
		if = {
			limit = {
				has_activity_intent = promote_rule_intent
			}
			add_legitimacy = minor_legitimacy_gain
		}
	}

	# If character had the raise dynasty prestige intent, give them renown
	root = {
		if = {
			limit = {
				has_activity_intent = raise_dynasty_prestige_intent
			}
			dynasty = {
				add_dynasty_prestige = medium_dynasty_prestige_gain
			}
		}
	}

	scope:activity = {
		every_attending_character = {
			limit = {
				NOT = {
					this = scope:host
				}
			}
			custom = custom.every_activity_guest
			disburse_activity_stress_loss = yes
		}
	}

	# Prestige level increase (For Host)
	scope:host = {
		if = {
			limit = {
				prestige_level <= 2 #Established and lower
			}
			add_prestige_level = 1
		}
	}

	# Accolade glory gain
	accolades_activity_complete_coronation_glory_effect = yes
}