agot_assign_bespoke_dynasty = {
	#Am I Bronn?
	if = {
		limit = {
			is_character_blackwater_1 = yes
			NOT = {
				house = house:house_Blackwater
			}
		}
		agot_convert_house_and_descendants_effect = {
			NEW_HOUSE = house:house_Blackwater
		}
	}

	#Am I Davos?
	if = {
		limit = {
			is_character_seaworth_1 = yes
			NOT = {
				house = house:house_Seaworth
			}
		}
		agot_convert_house_and_descendants_effect = {
			NEW_HOUSE = house:house_Seaworth
		}
	}

	#Am I Hard Hugh Hammer?
	if = {
		limit = {
			is_character_hammer_1 = yes
			NOT = {
				house = house:house_Hammer
			}
		}
		agot_convert_house_and_descendants_effect = {
			NEW_HOUSE = house:house_Hammer
		}
	}

	#Am I Ulf White?
	if = {
		limit = {
			is_character_white_1 = yes
			NOT = {
				house = house:house_White
			}
		}
		agot_convert_house_and_descendants_effect = {
			NEW_HOUSE = house:house_White
		}
	}

	#Am I Nettles?
	if = {
		limit = {
			is_character_farseed_1 = yes
			NOT = {
				house = house:house_Farseed
			}
		}
		agot_convert_house_and_descendants_effect = {
			NEW_HOUSE = house:house_Farseed
		}
	}

	#Am I Allard?
	if = {
		limit = {
			is_character_scaly_1 = yes
			NOT = {
				house = house:house_Scallard
			}
		}
		agot_convert_house_and_descendants_effect = {
			NEW_HOUSE = house:house_Scallard
		}
	}

	#Am I Aegor?
	if = {
		limit = {
			is_character_targaryen_95 = yes
			NOT = {
				house = house:house_Bittersteel
			}
		}
		hidden_effect = {
			house:house_Bittersteel = {
				add_house_modifier = dragonrider_house_modifier
			}
			agot_prune_personal_coa = yes
		}
		agot_convert_house_and_descendants_effect = {
			NEW_HOUSE = house:house_Bittersteel
		}
	}

	#Am I Duncan?
	if = {
		limit = {
			is_character_tall_1 = yes
			NOT = {
				house = house:house_Tall
			}
			NOT = {
				scope:title = title:d_kingsguard
			}
		}
		if = {
			limit = {
				has_nickname = nick_agot_historical_the_tall_duncan
			}
			remove_nickname = yes
		}
		trigger_event = agot_events_personal_coat_of_arms.0002
		agot_convert_house_and_descendants_effect = {
			NEW_HOUSE = house:house_Tall
		}
	}
}

agot_generate_westerosi_dynasty_name_effect = {
	save_scope_as = new_dynast

	set_global_variable = {
		name = cadet_new_name
		value = scope:new_dynast
	}

	scope:new_dynast.house ?= {
		set_house_name = cadet_name
	}
	scope:new_dynast.dynasty ?= {
		set_dynasty_name = cadet_name_for_dynasty
	}

	remove_global_variable = cadet_new_name
}

agot_house_revival_effect = {
	house = { save_scope_as = old_house }
	agot_convert_house_and_descendants_effect = {
		NEW_HOUSE = $NEW_HOUSE$
	}
	every_sibling ={
		limit = { house = scope:old_house }
		agot_convert_house_and_descendants_effect = {
			NEW_HOUSE = $NEW_HOUSE$
		}
	}
}

agot_convert_house_and_descendants_effect = {
	house = { save_scope_as = old_house }
	$NEW_HOUSE$ = { save_scope_as = new_house }
	set_house = scope:new_house
	every_child = {
		limit = { house = scope:old_house }
		set_house = scope:new_house
		every_child = {
			limit = { house = scope:old_house }
			set_house = scope:new_house
			every_child = {
				limit = { house = scope:old_house }
				set_house = scope:new_house
				every_child = {
					limit = { house = scope:old_house }
					set_house = scope:new_house
				}
			}
		}
	}
	scope:new_house = {
		every_house_member = {
			every_held_title = {
				set_coa = $NEW_HOUSE$.house_founder.dynasty
				if = {
					limit = {
						title_uses_legitimate_house_mechanic = yes
					}
					save_scope_as = legitimate_house_title_to_change
					agot_set_current_house = {
						HOUSE = scope:new_house
						TITLE = scope:legitimate_house_title_to_change
					}
					if = {
						limit = {
							var:legitimate_house = scope:old_house
						}
						agot_set_legitimate_house = {
							HOUSE = scope:new_house
							TITLE = scope:legitimate_house_title_to_change
						}
					}
				}
			}
		}
	}
}