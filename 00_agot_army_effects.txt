
kill_enemy_army_troops_by_percentage = {
	save_scope_as = army_commander_killing_enemies
	commanding_army.location = {
		every_army_in_location = {
			limit = {
				is_army_in_combat = yes # Is an army in combat
				trigger_if = { # That is on the opposing side
					limit = {
						scope:army_commander_killing_enemies.commanding_army.involved_combat_side = {
							is_combat_side_attacker = yes
						}
					}
					involved_combat_side = { is_combat_side_attacker = no }
				}
				trigger_if = {
					limit = {
						scope:army_commander_killing_enemies.commanding_army.involved_combat_side = {
							is_combat_side_attacker = no
						}
					}
					involved_combat_side = { is_combat_side_attacker = yes }
				}
			}
			save_scope_as = enemy_army
			if = { # Need to do this in effect block rather than the above limit to pass the scope to the custom trigger
				limit = {
					is_enemy_army = {
						ASKER = scope:army_commander_killing_enemies
						ARMY = scope:enemy_army
					}
				}
				deplete_army_by_percentage = $PERCENTAGE$
			}
		}
	}
}