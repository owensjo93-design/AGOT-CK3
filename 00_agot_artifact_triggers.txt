agot_is_important_artifact = {
	has_variable = {
		name = historical_unique_artifact
		name = valyrian_steel
		name = dragon_egg
	}
}

agot_artifact_can_take = {
	has_none_of_variables = {
		name = maesterwork
		name = historical_throne
		name = white_book
		name = agot_swiper_no_swiping
	}
}

agot_valid_ai_gift = {
	OR = {
		rarity = common
		rarity = masterwork
	}
	NOT = { agot_is_important_artifact = yes }
	has_none_of_variables = {
		name = agot_artifact_cannot_gift
		name = maesterwork
	}
}

agot_can_trade_artifacts_trigger = {
	at_can_trade_artifacts_trigger = yes
	trigger_if = {
		limit = { is_ai = yes }
		highest_held_title_tier >= tier_county
		trigger_if = {
			limit = { exists = global_var:agot_artifact_keeper }
			NOT = { this = global_var:agot_artifact_keeper }
		}
	}
}

agot_is_valyrian_steel_artifact = {
	has_variable = valyrian_steel
}

agot_is_dragon_egg_artifact = {
	has_variable = dragon_egg
}

agot_is_unique_throne_artifact = {
	artifact_type = throne_special
}

agot_is_historical_unique_artifact = {
	has_variable = historical_unique_artifact
}

# Selling special artifacts to the merchant is controlled via events
agot_is_special_artifact = {
	OR = {
		agot_is_valyrian_steel_artifact = yes
		agot_is_dragon_egg_artifact = yes
	}
}

agot_ai_may_sell_artifact_trigger = {
	# Save buyer and seller
	save_temporary_scope_as = seller
	global_var:agot_artifact_keeper = { save_temporary_scope_as = buyer }

	# Has artifacts that the merchant could buy
	has_variable_list = agot_owned_artifacts
	variable_list_size = { name = agot_owned_artifacts value > 0 }

	# The buyer can be sold artifacts to by the seller at the moment
	scope:buyer = {
		at_can_sell_artifact_to_trigger = { PARTY = scope:seller }
	}
}

agot_ai_may_buy_artifact_trigger = {
	# Save buyer and seller
	save_temporary_scope_as = buyer
	global_var:agot_artifact_keeper = { save_temporary_scope_as = seller }

	# Not at war
	is_at_war = no

	# The seller can be bought artifacts from by the buyer at the moment
	scope:seller = {
		at_can_buy_artifact_from_trigger = { PARTY = scope:buyer }
	}
}

agot_artifact_can_be_sold_trigger = {
	at_artifact_can_be_sold_trigger = yes
	at_artifact_can_be_bought_by_trigger = { BUYER = global_var:agot_artifact_keeper }
}

agot_artifact_can_be_destroyed_trigger = {
	at_artifact_can_be_destroyed_trigger = yes
}

agot_artifact_throne_county = {
	OR = {
		scope:title = title:c_kings_landing
		scope:title = title:c_pyke
		scope:title = title:c_casterly_rock
		scope:title = title:c_highgarden
		scope:title = title:c_winterfell
		scope:title = title:c_the_eyrie
		scope:title = title:c_dragonstone
	}
}